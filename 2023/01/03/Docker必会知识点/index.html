<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"foursevenlove.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Dockerå¿…ä¼šçŸ¥è¯†ç‚¹1.å¸¸ç”¨å‘½ä»¤1.1 æœåŠ¡ æŸ¥çœ‹Dockerç‰ˆæœ¬ä¿¡æ¯  1docker version  æŸ¥çœ‹dockerç®€è¦ä¿¡æ¯  1docker -v">
<meta property="og:type" content="article">
<meta property="og:title" content="Dockerå¿…ä¼šçŸ¥è¯†ç‚¹">
<meta property="og:url" content="https://foursevenlove.github.io/2023/01/03/Docker%E5%BF%85%E4%BC%9A%E7%9F%A5%E8%AF%86%E7%82%B9/index.html">
<meta property="og:site_name" content="foursevenlove">
<meta property="og:description" content="Dockerå¿…ä¼šçŸ¥è¯†ç‚¹1.å¸¸ç”¨å‘½ä»¤1.1 æœåŠ¡ æŸ¥çœ‹Dockerç‰ˆæœ¬ä¿¡æ¯  1docker version  æŸ¥çœ‹dockerç®€è¦ä¿¡æ¯  1docker -v">
<meta property="og:locale">
<meta property="article:published_time" content="2023-01-03T01:31:44.000Z">
<meta property="article:modified_time" content="2023-01-03T02:18:02.692Z">
<meta property="article:author" content="foursevenlove">
<meta property="article:tag" content="Docker">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://foursevenlove.github.io/2023/01/03/Docker%E5%BF%85%E4%BC%9A%E7%9F%A5%E8%AF%86%E7%82%B9/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>Dockerå¿…ä¼šçŸ¥è¯†ç‚¹ | foursevenlove</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">foursevenlove</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/aboutMe/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://foursevenlove.github.io/2023/01/03/Docker%E5%BF%85%E4%BC%9A%E7%9F%A5%E8%AF%86%E7%82%B9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/funs.jpg">
      <meta itemprop="name" content="foursevenlove">
      <meta itemprop="description" content="Keep on going never give up!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="foursevenlove">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Dockerå¿…ä¼šçŸ¥è¯†ç‚¹
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2023-01-03 09:31:44 / Modified: 10:18:02" itemprop="dateCreated datePublished" datetime="2023-01-03T09:31:44+08:00">2023-01-03</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Docker/" itemprop="url" rel="index"><span itemprop="name">Docker</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Dockerå¿…ä¼šçŸ¥è¯†ç‚¹"><a href="#Dockerå¿…ä¼šçŸ¥è¯†ç‚¹" class="headerlink" title="Dockerå¿…ä¼šçŸ¥è¯†ç‚¹"></a>Dockerå¿…ä¼šçŸ¥è¯†ç‚¹</h1><h2 id="1-å¸¸ç”¨å‘½ä»¤"><a href="#1-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="1.å¸¸ç”¨å‘½ä»¤"></a>1.å¸¸ç”¨å‘½ä»¤</h2><h3 id="1-1-æœåŠ¡"><a href="#1-1-æœåŠ¡" class="headerlink" title="1.1 æœåŠ¡"></a>1.1 æœåŠ¡</h3><ul>
<li>æŸ¥çœ‹Dockerç‰ˆæœ¬ä¿¡æ¯</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker version</span><br></pre></td></tr></table></figure>
<ul>
<li>æŸ¥çœ‹dockerç®€è¦ä¿¡æ¯</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker -v</span><br></pre></td></tr></table></figure>
<span id="more"></span>
<ul>
<li>å¯åŠ¨Docker</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker</span><br></pre></td></tr></table></figure>
<ul>
<li>å…³é—­docker</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop docker</span><br></pre></td></tr></table></figure>
<ul>
<li>è®¾ç½®å¼€æœºå¯åŠ¨</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable docker</span><br></pre></td></tr></table></figure>
<ul>
<li>é‡å¯dockeræœåŠ¡</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service docker restart</span><br></pre></td></tr></table></figure>
<ul>
<li>å…³é—­dockeræœåŠ¡</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service docker stop</span><br></pre></td></tr></table></figure>
<h3 id="1-2-é•œåƒ"><a href="#1-2-é•œåƒ" class="headerlink" title="1.2 é•œåƒ"></a>1.2 é•œåƒ</h3><ul>
<li>æ£€ç´¢é•œåƒ</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search å…³é”®å­—</span><br></pre></td></tr></table></figure>
<ul>
<li>æ‹‰å–é•œåƒ</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull [é€‰é¡¹] [Docker Registry åœ°å€[:ç«¯å£å·]/]ä»“åº“å[:æ ‡ç­¾]</span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ—å‡ºé•œåƒ</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker image ls</span><br><span class="line">docker images</span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ é™¤é•œåƒ</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi &lt;é•œåƒId&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>å¯¼å‡ºé•œåƒ</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker save</span><br></pre></td></tr></table></figure>
<ul>
<li>å¯¼å…¥é•œåƒ</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker load</span><br></pre></td></tr></table></figure>
<ul>
<li><p>Dockerfileå¸¸è§æŒ‡ä»¤</p>
<p>FROMï¼šæŒ‡å®šåŸºç¡€é•œåƒ </p>
<p>RUNï¼šæ‰§è¡Œå‘½ä»¤ </p>
<p>COPYï¼šå¤åˆ¶æ–‡ä»¶ </p>
<p>ADDï¼šæ›´é«˜çº§çš„å¤åˆ¶æ–‡ä»¶ </p>
<p>CMDï¼šå®¹å™¨å¯åŠ¨å‘½ä»¤ </p>
<p>ENVï¼šè®¾ç½®ç¯å¢ƒå˜é‡ </p>
<p>EXPOSEï¼šæš´éœ²ç«¯å£ </p>
</li>
</ul>
<p>å…¶å®ƒçš„æŒ‡ä»¤è¿˜æœ‰ENTRYPOINTã€ARGã€VOLUMEã€WORKDIRã€USERã€HEALTHCHECKã€ONBUILDã€LABELç­‰ç­‰ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªDockerfileå®ä¾‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">FROM java:8</span><br><span class="line">MAINTAINER &quot;jinshw&quot;&lt;jinshw@qq.com&gt;</span><br><span class="line">ADD mapcharts-0.0.1-SNAPSHOT.jar mapcharts.jar</span><br><span class="line">EXPOSE 8080</span><br><span class="line">CMD java -jar mapcharts.jar</span><br></pre></td></tr></table></figure>
<ul>
<li>é•œåƒæ„å»º</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build</span><br></pre></td></tr></table></figure>
<h3 id="1-3-å®¹å™¨"><a href="#1-3-å®¹å™¨" class="headerlink" title="1.3 å®¹å™¨"></a>1.3 å®¹å™¨</h3><h4 id="1-3-1-å®¹å™¨ç”Ÿå‘½å‘¨æœŸ"><a href="#1-3-1-å®¹å™¨ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="1.3.1 å®¹å™¨ç”Ÿå‘½å‘¨æœŸ"></a>1.3.1 å®¹å™¨ç”Ÿå‘½å‘¨æœŸ</h4><ul>
<li>å¯åŠ¨ï¼šå¯åŠ¨å®¹å™¨æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯åŸºäºé•œåƒæ–°å»ºä¸€ä¸ªå®¹å™¨å¹¶å¯åŠ¨ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯å°†åœ¨ç»ˆæ­¢çŠ¶æ€ï¼ˆstoppedï¼‰çš„å®¹å™¨é‡æ–°å¯åŠ¨ã€‚</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ–°å»ºå¹¶å¯åŠ¨</span></span><br><span class="line">docker run [é•œåƒå/é•œåƒID]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨å·²ç»ˆæ­¢å®¹å™¨</span></span><br><span class="line">docker start [å®¹å™¨ID]</span><br></pre></td></tr></table></figure>
<ul>
<li>æŸ¥çœ‹å®¹å™¨</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ—å‡ºæœ¬æœºè¿è¡Œçš„å®¹å™¨</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker ps</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ—å‡ºæœ¬æœºæ‰€æœ‰çš„å®¹å™¨ï¼ˆåŒ…æ‹¬åœæ­¢å’Œè¿è¡Œï¼‰</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker ps -a</span></span><br></pre></td></tr></table></figure>
<ul>
<li>åœæ­¢å®¹å™¨</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åœæ­¢è¿è¡Œçš„å®¹å™¨</span></span><br><span class="line">docker stop [å®¹å™¨ID]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ€æ­»å®¹å™¨è¿›ç¨‹</span></span><br><span class="line">docker  kill [å®¹å™¨ID] </span><br></pre></td></tr></table></figure>
<ul>
<li>é‡å¯å®¹å™¨</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker restart [å®¹å™¨ID] </span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ é™¤å®¹å™¨</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker  rm [å®¹å™¨ID]</span><br></pre></td></tr></table></figure>
<h4 id="1-3-2-è¿›å…¥å®¹å™¨"><a href="#1-3-2-è¿›å…¥å®¹å™¨" class="headerlink" title="1.3.2 è¿›å…¥å®¹å™¨"></a>1.3.2 è¿›å…¥å®¹å™¨</h4><p>è¿›å…¥å®¹å™¨æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¦‚æœä»è¿™ä¸ª stdin ä¸­ <span class="built_in">exit</span>ï¼Œä¼šå¯¼è‡´å®¹å™¨çš„åœæ­¢</span></span><br><span class="line">docker attach [å®¹å™¨ID]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">äº¤äº’å¼è¿›å…¥å®¹å™¨</span></span><br><span class="line">docker exec [å®¹å™¨ID]</span><br></pre></td></tr></table></figure>
<p>è¿›å…¥å®¹å™¨é€šå¸¸ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼ï¼Œ<code>docker exec</code>åé¢è·Ÿçš„å¸¸è§å‚æ•°å¦‚ä¸‹ï¼š</p>
<p>-d, â€”detach åœ¨å®¹å™¨ä¸­åå°æ‰§è¡Œå‘½ä»¤ï¼› ï¼ i, â€”interactive=true I false ï¼šæ‰“å¼€æ ‡å‡†è¾“å…¥æ¥å—ç”¨æˆ·è¾“å…¥å‘½ä»¤ï¼›-t :åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯</p>
<h4 id="1-3-3-å¯¼å‡ºå’Œå¯¼å…¥"><a href="#1-3-3-å¯¼å‡ºå’Œå¯¼å…¥" class="headerlink" title="1.3.3 å¯¼å‡ºå’Œå¯¼å…¥"></a>1.3.3 å¯¼å‡ºå’Œå¯¼å…¥</h4><ul>
<li>å¯¼å‡ºå®¹å™¨</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å¯¼å‡ºä¸€ä¸ªå·²ç»åˆ›å»ºçš„å®¹å™¨åˆ°ä¸€ä¸ªæ–‡ä»¶</span></span><br><span class="line">docker export [å®¹å™¨ID]</span><br></pre></td></tr></table></figure>
<ul>
<li>å¯¼å…¥å®¹å™¨</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯¼å‡ºçš„å®¹å™¨å¿«ç…§æ–‡ä»¶å¯ä»¥å†å¯¼å…¥ä¸ºé•œåƒ</span></span><br><span class="line">docker import [è·¯å¾„]</span><br></pre></td></tr></table></figure>
<h3 id="1-4-å…¶å®ƒ"><a href="#1-4-å…¶å®ƒ" class="headerlink" title="1.4 å…¶å®ƒ"></a>1.4 å…¶å®ƒ</h3><ul>
<li>æŸ¥çœ‹æ—¥å¿—</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs [å®¹å™¨ID]</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªå‘½ä»¤æœ‰ä»¥ä¸‹å¸¸ç”¨å‚æ•° -f : è·Ÿè¸ªæ—¥å¿—è¾“å‡º</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--since :æ˜¾ç¤ºæŸä¸ªå¼€å§‹æ—¶é—´çš„æ‰€æœ‰æ—¥å¿—</span><br><span class="line"></span><br><span class="line">-t : æ˜¾ç¤ºæ—¶é—´æˆ³</span><br><span class="line"></span><br><span class="line">--tail :ä»…åˆ—å‡ºæœ€æ–°Næ¡å®¹å™¨æ—¥å¿—</span><br></pre></td></tr></table></figure>
<ul>
<li>å¤åˆ¶æ–‡ä»¶</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä»ä¸»æœºå¤åˆ¶åˆ°å®¹å™¨</span></span><br><span class="line">sudo docker cp host_path containerID:container_path </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä»å®¹å™¨å¤åˆ¶åˆ°ä¸»æœº</span></span><br><span class="line">sudo docker cp containerID:container_path host_path</span><br></pre></td></tr></table></figure>
<h2 id="2-å®¹å™¨æŠ€æœ¯"><a href="#2-å®¹å™¨æŠ€æœ¯" class="headerlink" title="2. å®¹å™¨æŠ€æœ¯"></a>2. å®¹å™¨æŠ€æœ¯</h2><h3 id="2-1-ä»è¿›ç¨‹è¯´èµ·"><a href="#2-1-ä»è¿›ç¨‹è¯´èµ·" class="headerlink" title="2.1 ä»è¿›ç¨‹è¯´èµ·"></a>2.1 ä»è¿›ç¨‹è¯´èµ·</h3><p><strong>ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ</strong></p>
<p>ä»OSçš„å±‚é¢æ¥è¯´ï¼Œè¿›ç¨‹å°±æ˜¯ç¨‹åºçš„è¿è¡Œæ—¶ï¼Œä»£ç å’Œæ•°æ®é™æ€çš„ä¿å­˜åœ¨ç£ç›˜ä¸Šçš„æ—¶å€™å°±æ˜¯ç¨‹åºï¼Œä¸€æ—¦è¿™ä¸ªç¨‹åºçœŸæ­£è¿è¡Œèµ·æ¥äº†ï¼Œé‚£ä¹ˆå°±æˆäº†è¿›ç¨‹ã€‚</p>
<p>è€Œå®¹å™¨æŠ€æœ¯çš„æ ¸å¿ƒå°±æ˜¯é€šè¿‡<strong>çº¦æŸå’Œä¿®æ”¹è¿›ç¨‹çš„åŠ¨æ€è¡¨ç°</strong>ï¼Œä¸ºå…¶åˆ›é€ ä¸€ä¸ªâ€œè¾¹ç•Œâ€ã€‚å¯¹äºDockerè¿™ç§Linuxå®¹å™¨æ¥è¯´ï¼Œé€šè¿‡CGroupæŠ€æœ¯æ¥åˆ¶é€ çº¦æŸï¼Œé€šè¿‡Namespaceæ¥ä¿®æ”¹è¿›ç¨‹è§†å›¾ã€‚</p>
<p>ä»ä¸€ä¸ªä¾‹å­çœ‹ä¸€ä¸‹Namespaceå¯ä»¥å®Œæˆä»€ä¹ˆäº‹æƒ…ï¼š</p>
<p>å…ˆåˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -it busybox /bin/sh</span><br><span class="line">/ #</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨åœ¨å®¹å™¨ä¸­æ‰§è¡Œpså‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/ # ps</span><br><span class="line">PID   USER     TIME  COMMAND</span><br><span class="line">    1 root      0:00 /bin/sh</span><br><span class="line">    7 root      0:00 ps</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°è¿›ç¨‹å·æ˜¯ä»pid=1å¼€å§‹çš„ï¼Œå¹¶ä¸”åªæœ‰ä¸¤ä¸ªè¿›ç¨‹ï¼Œè¿™è·Ÿåœ¨å®¿ä¸»æœºä¸Šçš„ç»“æœä¸€å®šæ˜¯ä¸ä¸€æ ·çš„ã€‚äº‹å®ä¸Šåœ¨å®¿ä¸»æœºä¸­/bin/shè¿™æ¡å‘½ä»¤ä¸€å®šä¸æ˜¯pid=1çš„ï¼Œä½†æ˜¯Dockeré€šè¿‡éšœçœ¼æ³•è®©è¯¥è¿›ç¨‹çœ‹ä¸åˆ°åœ¨å®ƒä¹‹å‰çš„è¿›ç¨‹ï¼Œè¿™å°±æ˜¯åˆ©ç”¨äº†NamespaceæŠ€æœ¯ã€‚</p>
<p>Namaspaceå…¶å®åªæ˜¯Linuxåˆ›å»ºæ–°è¿›ç¨‹çš„ä¸€ä¸ªå¯é€‰å‚æ•°ã€‚åœ¨Linuxä¸­åˆ›å»ºè¿›ç¨‹é€šè¿‡clone()ï¼š</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> pid = <span class="built_in">clone</span>(main_functino, stack_size, SIGCHID, <span class="literal">NULL</span>);</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ç³»ç»Ÿè°ƒç”¨å°±ä¼šä¸ºæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¿›ç¨‹å¹¶ä¸”è¿”å›pidï¼Œå¦‚æœæˆ‘ä»¬æŒ‡å®šCLONE_NEWPIDå‚æ•°ï¼š</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> pid = <span class="built_in">clone</span>(main_functino, stack_size, CLONE_NEWPID ï½œ SIGCHID, <span class="literal">NULL</span>);</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ä¸€æ¥è¯¥è¿›ç¨‹å°±è¢«éª—äº†ï¼Œå®ƒå°†çœ‹åˆ°ä¸€ä¸ªèˆ¹æ–°ç‰ˆæœ¬çš„è¿›ç¨‹ç©ºé—´ï¼Œåœ¨è¿™ä¸ªè¿›ç¨‹ç©ºé—´ä¸­å®ƒçš„pidæ˜¯1ï¼Œä½†æ˜¯åœ¨å®¿ä¸»æœºä¸­å®ƒçš„pidæœ‰å¯èƒ½æ˜¯100ã€‚è¿™å°±æ˜¯ç®€å•çš„Namespaceçš„ä½¿ç”¨ï¼Œç”¨æ¥ä¿®æ”¹è¿›ç¨‹è§†å›¾ã€‚å½“ç„¶ï¼ŒLinuxè¿˜æä¾›äº†å…¶ä»–çš„namespaceå‚æ•°é€‰é¡¹ï¼šMOUNTã€UTSã€IPCã€Networkå’ŒUserï¼Œç”¨æ¥åšå„ç§éšœçœ¼æ³•ã€‚æ¯”å¦‚MOUNTç”¨æ¥è®©å½“å‰è¿›ç¨‹çœ‹åˆ°å½“å‰Namespaceçš„æŒ‚è½½ç‚¹ä¿¡æ¯ï¼ŒNetworkç”¨æ¥æ¥è¿›ç¨‹åªçœ‹åˆ°å½“å‰Namespaceçš„ç½‘ç»œè®¾å¤‡å’Œé…ç½®ã€‚</p>
<p>å®é™…ä¸Šå¯¹äºDockeræ¥è¯´ï¼Œç”¨äºåšå®¹å™¨éš”ç¦»çš„æ‰‹æ®µå…¶å®å°±æ˜¯åœ¨åˆ›å»ºå®¹å™¨è¿›ç¨‹çš„æ—¶å€™ï¼ŒæŒ‡å®šäº†è¯¥è¿›ç¨‹å¯åŠ¨æ‰€éœ€è¦çš„ä¸€ç»„Namespaceå‚æ•°ã€‚è¿™æ ·ä¸€æ¥ï¼Œè¯¥å®¹å™¨å°±åªèƒ½çœ‹åˆ°å½“å‰Namespaceä¸‹çš„èµ„æºã€æ–‡ä»¶ã€è®¾å¤‡ã€çŠ¶æ€æˆ–è€…é…ç½®ã€‚</p>
<p>æ‰€ä»¥ä¹ˆï¼Œå®¹å™¨è¿™ä¸ªé«˜å¤§ä¸Šçš„æ¦‚å¿µçš„æœ¬è´¨å…¶å®è¿˜æ˜¯è¿›ç¨‹ã€‚</p>
<h3 id="2-2-éš”ç¦»ä¸é™åˆ¶"><a href="#2-2-éš”ç¦»ä¸é™åˆ¶" class="headerlink" title="2.2 éš”ç¦»ä¸é™åˆ¶"></a>2.2 éš”ç¦»ä¸é™åˆ¶</h3><p>Linuxçš„NamespaceæŠ€æœ¯ç›¸å¯¹äºè™šæ‹ŸåŒ–æŠ€æœ¯å…¶å®è¿˜æ˜¯æœ‰ç¼ºé™·çš„ï¼Œæœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯ï¼šéš”ç¦»çš„ä¸å½»åº•ã€‚ æ—¢ç„¶å®¹å™¨åªæ˜¯ä¸€ç§ç‰¹æ®Šçš„è¿›ç¨‹ï¼Œé‚£ä¹ˆå®é™…ä¸Šå¤šä¸ªå®¹å™¨ä¹‹é—´ä½¿ç”¨çš„è¿˜æ˜¯åŒä¸€ä¸ªå®¿ä¸»æœºçš„æ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨windowsä¸Šè¿è¡ŒLinuxå®¹å™¨æ˜¯ä¸ç°å®çš„ã€‚å…¶æ¬¡ï¼Œåœ¨Linuxå†…æ ¸ä¸­ï¼Œæœ‰å¾ˆå¤šèµ„æºå’Œå¯¹è±¡æ˜¯ä¸èƒ½è¢«NamespaceåŒ–çš„ï¼Œæœ€å…¸å‹çš„ï¼šæ—¶é—´ã€‚æ¯”å¦‚ï¼Œå¦‚æœåœ¨å®¹å™¨ä¸­è°ƒç”¨settimeofday(2)ç³»ç»Ÿè°ƒç”¨ä¿®æ”¹äº†æ—¶é—´ï¼Œé‚£ä¹ˆæ•´ä¸ªå®¿ä¸»æœºçš„æ—¶é—´å°±ä¼šè¢«æ”¹å˜ï¼Œè¿™æ˜¯ä¸ç¬¦åˆé¢„æœŸçš„ã€‚</p>
<p>è¯´å®Œäº†éš”ç¦»ï¼Œä¸‹é¢æ¥è¯´è¯´é™åˆ¶ã€‚</p>
<p>è™½ç„¶å®¹å™¨å†…çš„ç¬¬1å·è¿›ç¨‹å¯èƒ½å®é™…ä¸Šæ˜¯å®¿ä¸»æœºä¸Šçš„ç¬¬100å·è¿›ç¨‹ï¼Œå¹¶ä¸”åªèƒ½çœ‹åˆ°å®¹å™¨å†…çš„è¿›ç¨‹ç©ºé—´ï¼Œä½†æ˜¯è¯¥è¿›ç¨‹ä½œä¸ºå®¿ä¸»æœºä¸Šçš„ç¬¬100å·è¿›ç¨‹ä¸å…¶ä»–è¿›ç¨‹ä¹‹é—´ä¾ç„¶æ˜¯å¹³ç­‰çš„ç«äº‰å…³ç³»ã€‚ä¹Ÿå°±æ˜¯ï¼Œç¬¬100å·è¿›ç¨‹æ‰€èƒ½ç”¨åˆ°çš„èµ„æºï¼ˆæ¯”å¦‚cpuã€å†…å­˜ï¼‰ï¼Œå¯ä»¥éšæ—¶è¢«å®¿ä¸»æœºä¸Šçš„å…¶ä»–è¿›ç¨‹æˆ–å…¶ä»–å®¹å™¨å ç”¨ã€‚å½“ç„¶ï¼Œç¬¬100å·è¿›ç¨‹ä¹Ÿæœ‰å¯èƒ½è‡ªå·±ç”¨å…‰å®¿ä¸»æœºä¸Šçš„æ‰€æœ‰èµ„æºã€‚è¿™äº›æ˜¾ç„¶éƒ½ä¸æ˜¯ä¸€ä¸ªå®¹å™¨çš„åˆç†è¡Œä¸ºã€‚</p>
<p>è€ŒLinux Cgoupgs(Linux control groups)å°±æ˜¯Linuxå†…æ ¸ä¸­ä¸ºè¿›ç¨‹è®¾ç½®èµ„æºé™åˆ¶çš„ä¸€ç§æŠ€æœ¯ã€‚å…¶æœ€ä¸»è¦çš„åŠŸèƒ½å°±æ˜¯é™åˆ¶ä¸€ä¸ªè¿›ç¨‹ç»„èƒ½å¤Ÿä½¿ç”¨çš„èµ„æºä¸Šé™ï¼ŒåŒ…æ‹¬CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œå¸¦å®½ç­‰ç­‰ã€‚æ­¤å¤–ï¼ŒCgroupè¿˜èƒ½å¯¹è¿›ç¨‹è¿›è¡Œä¼˜å…ˆçº§è®¾ç½®ã€å®¡è®¡ï¼Œä»¥åŠå°†è¿›ç¨‹æŒ‚èµ·å’Œæ¢å¤ç­‰æ“ä½œã€‚è¿™é‡Œæˆ‘ä»¬ä¸»è¦è¯´è¯´å®ƒçš„é™åˆ¶åŠŸèƒ½ã€‚</p>
<p>åœ¨Linuxä¸­ï¼ŒCgroupså‘ç”¨æˆ·æš´éœ²å‡ºæ¥çš„æ“ä½œæ¥å£æ˜¯æ–‡ä»¶ç³»ç»Ÿï¼Œå³å®ƒä»¥æ–‡ä»¶å’Œç›®å½•çš„æ–¹å¼ç»„ç»‡åœ¨æ“ä½œç³»ç»Ÿçš„/sys/fs/cgroupsè·¯å¾„ä¸‹ã€‚å¯ä»¥ç”¨mountå‘½ä»¤å°†å…¶æ˜¾ç¤ºï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mount -t cgroup</span><br><span class="line">cgroup on /sys/fs/cgroup/systemd type cgroup (rw,nosuid,nodev,noexec,relatime,xattr,release_agent=/usr/lib/systemd/systemd-cgroups-agent,name=systemd)</span><br><span class="line">cgroup on /sys/fs/cgroup/pids type cgroup (rw,nosuid,nodev,noexec,relatime,pids)</span><br><span class="line">cgroup on /sys/fs/cgroup/devices type cgroup (rw,nosuid,nodev,noexec,relatime,devices)</span><br><span class="line">cgroup on /sys/fs/cgroup/net_cls,net_prio type cgroup (rw,nosuid,nodev,noexec,relatime,net_prio,net_cls)</span><br><span class="line">cgroup on /sys/fs/cgroup/blkio type cgroup (rw,nosuid,nodev,noexec,relatime,blkio)</span><br><span class="line">cgroup on /sys/fs/cgroup/cpu,cpuacct type cgroup (rw,nosuid,nodev,noexec,relatime,cpuacct,cpu)</span><br><span class="line">cgroup on /sys/fs/cgroup/memory type cgroup (rw,nosuid,nodev,noexec,relatime,memory)</span><br><span class="line">cgroup on /sys/fs/cgroup/freezer type cgroup (rw,nosuid,nodev,noexec,relatime,freezer)</span><br><span class="line">cgroup on /sys/fs/cgroup/hugetlb type cgroup (rw,nosuid,nodev,noexec,relatime,hugetlb)</span><br><span class="line">cgroup on /sys/fs/cgroup/perf_event type cgroup (rw,nosuid,nodev,noexec,relatime,perf_event)</span><br><span class="line">cgroup on /sys/fs/cgroup/cpuset type cgroup (rw,nosuid,nodev,noexec,relatime,cpuset)</span><br></pre></td></tr></table></figure>
<p>åœ¨/sys/fs/cgrouopsç›®å½•ä¸‹çš„å­ç›®å½•ï¼Œæ¯”å¦‚cpuã€cpusetã€memoryï¼Œä¹Ÿå«å­ç³»ç»Ÿã€‚è¿™äº›æ˜¯å½“å‰æœºå™¨å¯ä»¥è¢«Cgroupsé™åˆ¶çš„èµ„æºç§ç±»ã€‚åœ¨å­ç³»ç»Ÿå¯¹åº”çš„èµ„æºç§ç±»ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°è¿™ç±»èµ„æºå…·ä½“å¯ä»¥è¢«é™åˆ¶çš„æ–¹æ³•ã€‚</p>
<p>æŸ¥çœ‹cpuç›®å½•ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> /sys/fs/cgroup/cpu</span></span><br><span class="line">aegis   cgroup.clone_children  cgroup.procs          cpuacct.stat   cpuacct.usage_percpu  cpu.cfs_quota_us  cpu.rt_runtime_us  cpu.stat  kubepods           release_agent  tasks</span><br><span class="line">assist  cgroup.event_control   cgroup.sane_behavior  cpuacct.usage  cpu.cfs_period_us     cpu.rt_period_us  cpu.shares         docker    notify_on_release  system.slice   user.slice</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­æœ‰ä¸¤ä¸ªæ–‡ä»¶cpu.cfs_period_uså’Œcpu.cfs_quota_usï¼Œç”¨æ¥é™åˆ¶è¿›ç¨‹åœ¨cpu.cfs_period_usçš„ä¸€æ®µæ—¶é—´å†…ï¼Œåªèƒ½è¢«åˆ†é…åˆ°æ€»é‡ä¸ºcpu.cfs_quota_usçš„cpuæ—¶é—´ã€‚</p>
<p>é‚£ä¹ˆè¦å¦‚ä½•ä½¿ç”¨è¿™æ ·çš„é…ç½®æ–‡ä»¶å‘¢ï¼Ÿåªéœ€è¦åœ¨å¯¹åº”çš„å­ç³»ç»Ÿä¸‹é¢åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œæ¯”å¦‚åœ¨/sys/fs/cgroup/cpuåˆ›å»ºä¸€ä¸ªtestæ–‡ä»¶å¤¹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mkdir test</span><br><span class="line">cd test/</span><br><span class="line">ll</span><br><span class="line">æ€»ç”¨é‡ 0</span><br><span class="line">-rw-r--r-- 1 root root 0 12æœˆ  6 17:30 cgroup.clone_children</span><br><span class="line">--w--w--w- 1 root root 0 12æœˆ  6 17:30 cgroup.event_control</span><br><span class="line">-rw-r--r-- 1 root root 0 12æœˆ  6 17:30 cgroup.procs</span><br><span class="line">-r--r--r-- 1 root root 0 12æœˆ  6 17:30 cpuacct.stat</span><br><span class="line">-rw-r--r-- 1 root root 0 12æœˆ  6 17:30 cpuacct.usage</span><br><span class="line">-r--r--r-- 1 root root 0 12æœˆ  6 17:30 cpuacct.usage_percpu</span><br><span class="line">-rw-r--r-- 1 root root 0 12æœˆ  6 17:30 cpu.cfs_period_us</span><br><span class="line">-rw-r--r-- 1 root root 0 12æœˆ  6 17:30 cpu.cfs_quota_us</span><br><span class="line">-rw-r--r-- 1 root root 0 12æœˆ  6 17:30 cpu.rt_period_us</span><br><span class="line">-rw-r--r-- 1 root root 0 12æœˆ  6 17:30 cpu.rt_runtime_us</span><br><span class="line">-rw-r--r-- 1 root root 0 12æœˆ  6 17:30 cpu.shares</span><br><span class="line">-r--r--r-- 1 root root 0 12æœˆ  6 17:30 cpu.stat</span><br><span class="line">-rw-r--r-- 1 root root 0 12æœˆ  6 17:30 notify_on_release</span><br><span class="line">-rw-r--r-- 1 root root 0 12æœˆ  6 17:30 tasks</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ä¸€ä¸ªç›®å½•ç§°ä¸ºä¸€ä¸ªâ€œæ§åˆ¶ç»„â€ï¼Œå¯ä»¥çœ‹åˆ°ç³»ç»Ÿè‡ªåŠ¨åœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºäº†ä¸€å †å¯¹åº”èµ„æºé™åˆ¶çš„æ–‡ä»¶ã€‚cpu.cfs_quota_usä¸º-1ä»£è¡¨æ²¡æœ‰é™åˆ¶ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cat cpu.cfs_quota_us</span><br><span class="line">-1</span><br><span class="line">cat cpu.cfs_period_us</span><br><span class="line">100000</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨åå°æ‰§è¡Œè„šæœ¬å¯åŠ¨ä¸€ä¸ªæ­»å¾ªç¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">while : ; do : ; done &amp;</span><br><span class="line">[1] 20600</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨topå‘½ä»¤æŸ¥çœ‹è¯¥è¿›ç¨‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">top</span><br><span class="line">top - 17:38:50 up 46 days, 17:38,  3 users,  load average: 0.82, 0.32, 0.14</span><br><span class="line">Tasks: 187 total,   2 running, 185 sleeping,   0 stopped,   0 zombie</span><br><span class="line"><span class="meta prompt_">%</span><span class="language-bash">Cpu(s): 13.1 us,  0.3 sy,  0.0 ni, 86.6 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span></span><br><span class="line">KiB Mem : 32245888 total, 12814256 free,  3753912 used, 15677720 buff/cache</span><br><span class="line">KiB Swap:        0 total,        0 free,        0 used. 28089768 avail Mem</span><br><span class="line"></span><br><span class="line">  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND</span><br><span class="line">20600 root      20   0  115680    708    160 R  99.7  0.0   1:37.50 bash</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°è¯¥è¿›ç¨‹çš„cpuä½¿ç”¨ç‡æ˜¯100%ï¼Œå‡å¦‚ç°åœ¨æƒ³è¦é™åˆ¶æ”¹è¿›ç¨‹çš„cpuä½¿ç”¨ç‡æ€ä¹ˆåŠï¼Ÿ</p>
<p>ç°åœ¨å†™å…¥æ–‡ä»¶ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo 20000 &gt; /sys/fs/cgroup/cpu/test/cpu.cfs_quota_us</span><br><span class="line">cat cpu.cfs_quota_us</span><br><span class="line">20000</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ä¸€æ¥å°±å¯ä»¥é™åˆ¶æŸä¸ªè¿›ç¨‹æœ€å¤šåªèƒ½ä½¿ç”¨20%çš„cpuã€‚ä½†æ˜¯è¿˜æ²¡æœ‰å¯¹æ”¹è¿›ç¨‹ç”Ÿæ•ˆï¼Œè¦å°†æ­¤é™åˆ¶å’Œè¿›ç¨‹ç»‘å®šä¸€ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">echo 20600 &gt; /sys/fs/cgroup/cpu/test/task</span><br><span class="line">top</span><br><span class="line">top - 17:40:59 up 46 days, 17:40,  3 users,  load average: 0.90, 0.54, 0.25</span><br><span class="line">Tasks: 187 total,   2 running, 185 sleeping,   0 stopped,   0 zombie</span><br><span class="line"><span class="meta prompt_">%</span><span class="language-bash">Cpu(s):  3.0 us,  0.2 sy,  0.0 ni, 96.8 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span></span><br><span class="line">KiB Mem : 32245888 total, 12814508 free,  3753508 used, 15677872 buff/cache</span><br><span class="line">KiB Swap:        0 total,        0 free,        0 used. 28090172 avail Mem</span><br><span class="line"></span><br><span class="line">  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND</span><br><span class="line">20600 root      20   0  115680    708    160 R  19.9  0.0   3:42.78 bash</span><br></pre></td></tr></table></figure>
<p>å†æ¬¡æŸ¥çœ‹è¯¥è¿›ç¨‹ä¼šå‘ç°cpuä½¿ç”¨ç‡åªæœ‰20%ã€‚</p>
<p>é™¤äº†cpuå­ç³»ç»Ÿä¹‹å¤–ï¼ŒCgroupsçš„æ¯ä¸€é¡¹å­ç³»ç»Ÿéƒ½æœ‰å…¶ç‹¬æœ‰çš„èµ„æºé™åˆ¶èƒ½åŠ›ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>blkioï¼Œä¸ºå—è®¾å¤‡è®¾å®šI/Oé™åˆ¶ï¼Œä¸€èˆ¬ç”¨äºç£ç›˜ç­‰è®¾å¤‡ã€‚</li>
<li>cpusetï¼Œ ä¸ºè¿›ç¨‹åˆ†é…å•ç‹¬çš„cpuæ ¸å’Œå¯¹åº”çš„å†…å­˜èŠ‚ç‚¹ã€‚</li>
<li>memoryï¼Œä¸ºè¿›ç¨‹è®¾å®šå†…å­˜çš„ä½¿ç”¨é™åˆ¶ã€‚</li>
</ul>
<p>Cgroupsä½¿ç”¨æ€»ç»“ï¼šä¸€ä¸ªå­ç³»ç»Ÿç›®å½•åŠ ä¸Šä¸€ç»„èµ„æºé™åˆ¶æ–‡ä»¶çš„ç»„åˆã€‚å¯¹äºDockerç­‰Linuxå®¹å™¨ï¼Œåªéœ€è¦åœ¨æ¯ä¸ªå­ç³»ç»Ÿä¸‹é¢ä¸ºæ¯ä¸ªå®¹å™¨åˆ›å»ºä¸€ä¸ªèµ„æºç»„ï¼ˆåˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ï¼‰ï¼Œç„¶ååœ¨å¯åŠ¨å®¹å™¨è¿›ç¨‹ä¹‹åï¼ŒæŠŠè¿™ä¸ªè¿›ç¨‹çš„PIDå¡«å†™åˆ°å¯¹åº”æ§åˆ¶ç»„çš„tasksæ–‡ä»¶ä¸­å³å¯ã€‚</p>
<p>å…¶å®ç”¨æˆ·åœ¨ä½¿ç”¨dockerå®¹å™¨çš„ä½¿ç”¨æƒ³è¦é™åˆ¶èµ„æºéå¸¸ç®€å•ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --cpu-period=100000 --cpu-quota=20000 ubuntu /bin/bash</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹å¯¹åº”çš„èµ„æºé™åˆ¶æ–‡ä»¶ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /sys/fs/cgroup/cpu/docker/b95b0a18ae7eaadcd395a32379aeeeec717ff0b1bdeb5c26697b6566e8ca8e</span><br><span class="line">cat cpu.cfs_quota_us</span><br><span class="line">20000</span><br><span class="line">cat cpu.cfs_period_us</span><br><span class="line">100000</span><br></pre></td></tr></table></figure>
<h3 id="2-3-å®¹å™¨é•œåƒ"><a href="#2-3-å®¹å™¨é•œåƒ" class="headerlink" title="2.3 å®¹å™¨é•œåƒ"></a>2.3 å®¹å™¨é•œåƒ</h3><p>é€šè¿‡Namespaceåšéš”ç¦»ï¼Œé€šè¿‡Cgroupsåšé™åˆ¶ï¼Œé‚£ä¹ˆä¸€ä¸ªå®¹å™¨è¿›ç¨‹çœ‹åˆ°çš„æ–‡ä»¶ç³»ç»Ÿæ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿä½ å¯èƒ½ä¼šè¯´ï¼Œå¦‚æœåˆ›å»ºè¿›ç¨‹æ—¶æŒ‡å®šäº†Mountå‚æ•°ï¼Œé‚£ä¹ˆå°±å¯ä»¥è®©å®¹å™¨è¿›ç¨‹çœ‹åˆ°ä¸€ä¸ªæ–°çš„æ–‡ä»¶ç³»ç»Ÿã€‚ä½†äº‹å®æ˜¯ï¼Œå³ä¾¿å¼€å¯äº†Mountå‚æ•°ï¼Œå®¹å™¨çœ‹åˆ°çš„æ–‡ä»¶ç³»ç»Ÿä¹Ÿå’Œå®¿ä¸»æœºçš„æ–‡ä»¶ç³»ç»Ÿä¸€è‡´ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºMount Namespaceå’Œå…¶ä»–Namespaceä¸ä¸€æ ·ï¼Œå®ƒå¯¹å®¹å™¨è¿›ç¨‹è§†å›¾çš„æ”¹å˜ä¸€å®šè¦ä¼´éšç€æŒ‚è½½æ“ä½œæ‰èƒ½ç”Ÿæ•ˆã€‚å› æ­¤ï¼Œåœ¨å®¹å™¨è¿›ç¨‹å¯åŠ¨ä¹‹å‰è¦é‡æ–°æŒ‚è½½æ•´ä¸ªæ ¹ç›®å½•â€/â€œï¼Œè¿™æ ·ä¸€æ¥å®¹å™¨å†…çš„æŒ‚è½½å¯¹å®¿ä¸»æœºä¸å¯è§ï¼Œå› æ­¤å®¹å™¨è¿›ç¨‹å¯ä»¥åœ¨é‡Œé¢éšä¾¿æŠ˜è…¾ã€‚</p>
<p>åœ¨Linuxä¸­ï¼Œå¯ä»¥é€šè¿‡<code>chroot</code>å‘½ä»¤æ¥æ‰§è¡ŒæŒ‚è½½æ“ä½œï¼Œé¡¾åæ€ä¹‰ï¼šâ€œchange  root file systemâ€ï¼Œæ”¹å˜è¿›ç¨‹çš„æ ¹è·¯å¾„åˆ°ä»»ä½•åœ°æ–¹ã€‚</p>
<p>ä¸ºäº†è®©å®¹å™¨çš„æ ¹ç›®å½•çœ‹èµ·æ¥æ›´åŠ çœŸå®ï¼Œä¸€èˆ¬ä¼šåœ¨å®¹å™¨çš„æ ¹ç›®å½•ä¸‹æŒ‚è½½æˆ‘ä¸€ä¸ªå®Œæ•´æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿï¼Œæ¯”å¦‚Ubuntu16.04çš„ISOã€‚è¿™æ ·åœ¨å®¹å™¨å¯åŠ¨ä»¥åï¼Œåœ¨å®¹å™¨é‡Œæ‰§è¡Œls /å‘½ä»¤çœ‹åˆ°çš„å°±æ˜¯Ubuntu 16.04çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶ã€‚è¿™ä¸ªæŒ‚è½½åœ¨å®¹å™¨æ ¹ç›®å½•ä¸Šç”¨æ¥ä¸ºå®¹å™¨è¿›ç¨‹æä¾›éš”ç¦»åæ‰§è¡Œç¯å¢ƒçš„æ–‡ä»¶ç³»ç»Ÿï¼Œå°±æ˜¯â€œå®¹å™¨é•œåƒâ€ã€‚å®ƒè¿˜æœ‰ä¸€ä¸ªæ›´ä¸“ä¸šçš„åå­—å«ï¼šrootfs(æ ¹æ–‡ä»¶ç³»ç»Ÿ)ã€‚</p>
<p>è‡³æ­¤ï¼ŒDockerçš„æ ¸å¿ƒåŸç†å…¨éƒ¨éƒ½å‡ºæ¥äº†ï¼š</p>
<ul>
<li>Linux Namespace</li>
<li>Cgroups</li>
<li>change root</li>
</ul>
<p>ç”±äºrootfsçš„å­˜åœ¨ï¼Œå®¹å™¨å°±æœ‰äº†ä¸€ä¸ªååˆ†é‡è¦çš„ç‰¹æ€§ï¼šä¸€è‡´æ€§ã€‚æœ‰ä¸ªrootfsä¹‹åï¼Œåº”ç”¨æ‰“åŒ…çš„ä¸åªæ˜¯åº”ç”¨ï¼Œè€Œæ˜¯æ•´ä¸ªæ“ä½œç³»ç»Ÿçš„æ–‡ä»¶å’Œç›®å½•ï¼Œè¿™å°±æ„å‘³ç€ï¼Œåº”ç”¨ä»¥åŠå®ƒæ‰€éœ€è¦è¿è¡Œçš„æ‰€æœ‰ä¾èµ–éƒ½è¢«å°è£…åˆ°ä¸€èµ·äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰äº†å®¹å™¨é•œåƒï¼Œä¸ç®¡åœ¨æœ¬åœ°è¿˜æ˜¯äº‘ç«¯è¿˜æ˜¯ä»»ä½•ä¸€å°æœºå™¨ï¼Œåªè¦è§£å‹æ‰“åŒ…å¥½çš„å®¹å™¨é•œåƒï¼Œåº”ç”¨ä»¥åŠæ‰€éœ€çš„æ‰§è¡Œç¯å¢ƒå°±èƒ½è¢«é‡ç°ã€‚</p>
<p>åœ¨åˆ¶ä½œä¸€ä¸ªrootfsçš„æ—¶å€™ï¼Œä¸ºäº†ç®€åŒ–åˆ¶ä½œã€ä¸éœ€è¦é‡å¤åˆ¶ä½œï¼Œrootfsæ˜¯åŸºäºå¢é‡ä¿®æ”¹çš„ã€‚è¿™ä¹Ÿå°±æ˜¯Dockeré•œåƒä¸­<strong>å±‚ï¼ˆlayerï¼‰</strong>çš„æ¦‚å¿µã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨æˆ·åˆ¶ä½œé•œåƒçš„æ¯ä¸€æ­¥æ“ä½œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªå±‚ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå¢é‡rootfsã€‚è¿™é‡Œä¸»è¦ç”¨åˆ°äº†<strong>UnionFSï¼ˆè”åˆæ–‡ä»¶ç³»ç»Ÿï¼‰</strong>çš„èƒ½åŠ›ï¼Œå…¶æœ€ä¸»è¦çš„åŠŸèƒ½æ˜¯å°†ä¸åŒä½ç½®çš„ç›®å½•<strong>è”åˆæŒ‚è½½ï¼ˆunion mount</strong>ï¼‰åˆ°åŒä¸€ä¸ªç›®å½•ä¸‹ã€‚</p>
<p>å‡è®¾æ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tree</span><br><span class="line">.</span><br><span class="line">â”œâ”€â”€ A</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ a</span><br><span class="line">â”‚Â Â  â””â”€â”€ x</span><br><span class="line">â””â”€â”€ B</span><br><span class="line">    â”œâ”€â”€ b</span><br><span class="line">    â””â”€â”€ x</span><br><span class="line"></span><br><span class="line">2 directories, 4 files</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡è”åˆæŒ‚è½½çš„æ–¹å¼å°†è¿™ä¸¤ä¸ªç›®å½•æŒ‚è½½åˆ°ä¸€ä¸ªå…¬å…±å¾—åˆ†ç›®å½•Cä¸Š(Centos 7)ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mkdir</span><br><span class="line">mount -t overlay overlay -o lowerdir=A:B ~/test2/C</span><br><span class="line">tree ./C</span><br><span class="line">./C</span><br><span class="line">â”œâ”€â”€ a</span><br><span class="line">â”œâ”€â”€ b</span><br><span class="line">â””â”€â”€ x</span><br><span class="line"></span><br><span class="line">0 directories, 3 files</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶Cæ–‡ä»¶å¤¹ä¸‹å°±èƒ½çœ‹åˆ°Aå’ŒBæ–‡ä»¶å¤¹çš„æ–‡ä»¶è¢«åˆå¹¶åˆ°äº†ä¸€èµ·ã€‚å¹¶ä¸”å¦‚æœä¿®æ”¹Cæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶ï¼ŒåŸæœ¬æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶ä¹Ÿä¼šç›¸åº”ä¿®æ”¹ã€‚</p>
<p>ä¸‹é¢ä»¥Ubuntu16.04å’ŒDocker CE18.05æ¥è¯´æ˜Dockeræ˜¯å¦‚ä½•ä½¿ç”¨è¿™ç§UnionFSçš„ï¼Œåœ¨è¿™ä¸ªç¯å¢ƒé…ç½®ä¸‹ä½¿ç”¨çš„æ˜¯Another UnionFSï¼Œåæ¥å«Alternative UnionFSï¼Œå†åæ¥å«Advanced UnionFSã€‚å¯¹AuFSæ¥è¯´ï¼Œæœ€å…³é”®çš„ç›®å½•ç»“æ„åœ¨/var/lib/dockerè·¯å¾„ä¸‹çš„diffç›®å½•ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/lib/docker/aufs/diff/&lt;layer_id&gt;</span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d ubuntu:latest sleep 3600</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹é•œåƒï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect image ubuntu:latest</span><br></pre></td></tr></table></figure>
<p>ä¼šå‘ç°è¿™ä¸ªé•œåƒç”±5ä¸ªå±‚ç»„æˆï¼Œè¿™5å±‚å°±æ˜¯5ä¸ªå¢é‡rootfsï¼Œæ¯ä¸€å±‚éƒ½æ˜¯Ubuntuæ“ä½œç³»ç»Ÿæ–‡ä»¶ä¸ç›®å½•çš„ä¸€éƒ¨åˆ†ï¼›è€Œåœ¨ä½¿ç”¨çš„æ—¶å€™ï¼ŒDockerä¼šæŠŠè¿™äº›å¢é‡è”åˆæŒ‚è½½åˆ°ä¸€ä¸ªç»Ÿä¸€çš„æŒ‚è½½ç‚¹ä¸Šï¼ˆç›¸å½“äºä¹‹å‰çš„Cç›®å½•ï¼‰ã€‚è¿™ä¸ªæŒ‚è½½ç‚¹å°±æ˜¯/var/lib/docker/aufs/mnt/<ID>ã€‚</p>
<p>å®¹å™¨çš„rootfsä¸€èˆ¬ç”±3éƒ¨åˆ†ç»„æˆï¼šå¯è¯»å¯å†™å±‚ï¼ˆrwï¼‰ã€Initå±‚ï¼ˆro+whï¼‰ã€åªè¯»å±‚ï¼ˆro+whï¼‰ã€‚</p>
<ol>
<li>åªè¯»å±‚</li>
</ol>
<p>å¯¹åº”åŸæœ¬é•œåƒçš„å±‚æ•°ï¼Œæ¯”å¦‚ubuntuè¿™ä¸ªé•œåƒçš„5å±‚ ï¼Œreadonly+whiteoutã€‚</p>
<ol>
<li>å¯è¯»å¯å†™å±‚</li>
</ol>
<p>Read writeï¼Œè¿™æ˜¯rootfsä¸­æœ€ä¸Šé¢çš„ä¸€å±‚ï¼Œåœ¨å†™å…¥æ–‡ä»¶ä¹‹å‰è¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯ç©ºçš„ï¼Œä¸€æ—¦åœ¨å®¹å™¨ä¸­è¿›è¡Œäº†å†™æ“ä½œï¼Œä¿®æ”¹çš„å†…å®¹å°±ä¼šä»¥å¢é‡çš„æ–¹å¼å‡ºç°åœ¨è¯¥å±‚ä¸­ã€‚å¦‚æœæƒ³æ‰§è¡Œåˆ é™¤åªè¯»å±‚é‡Œçš„ä¸€ä¸ªæ–‡ä»¶ï¼Œå°±ä¼šåœ¨å¯è¯»å¯å†™å±‚å…ˆåˆ›å»ºä¸€ä¸ªwhiteoutæ–‡ä»¶ï¼ŒæŠŠåªè¯»å±‚é‡Œçš„æ–‡ä»¶é®æŒ¡ä½ã€‚æ¯”å¦‚æƒ³åˆ é™¤åªè¯»å±‚ä¸­ä¸€ä¸ªfooæ–‡ä»¶ï¼Œå°±ä¼šç°åœ¨å¯è¯»å¯å†™å±‚ä¸­åˆ›å»ºä¸€ä¸ªfoo.whiteoutæ–‡ä»¶ï¼Œè¿™æ ·å½“ä¸¤ä¸ªå±‚è¢«è”åˆæŒ‚è½½ä¹‹åï¼Œfooæ–‡ä»¶å°±è¢«foo.whiteé®æŒ¡ä½ã€‚æ‰€ä»¥å¯¹ä¸€ä¸ªå®¹å™¨ä¸­æ–‡ä»¶çš„å¢åˆ æ”¹æŸ¥éƒ½åªä¼šåœ¨å¯è¯»å¯å†™å±‚ä¸­æ“ä½œï¼Œå¹¶ä¸ä¼šå½±å“åˆ°åŸæœ‰çš„é•œåƒåªè¯»å±‚ã€‚</p>
<ol>
<li>Initå±‚</li>
</ol>
<p>è¿™ä¸€å±‚æ˜¯ä¸“é—¨ä»¥-initç»“å°¾çš„å±‚ï¼Œå¤¹åœ¨åªè¯»å±‚å’Œå¯è¯»å¯å†™å±‚ä¹‹é—´ï¼Œæ˜¯dockerå•ç‹¬ç”Ÿæˆçš„ä¸€ä¸ªå†…éƒ¨å±‚ï¼Œä¸“é—¨ç”¨æ¥å­˜æ”¾/etc/hostsã€/etc/resolv.confç­‰ä¿¡æ¯ã€‚éœ€è¦è¿™ä¸€å±‚çš„åŸå› æ˜¯ï¼Œç”¨æˆ·åœ¨å¯åŠ¨å®¹å™¨æ—¶éœ€è¦å†™å…¥ä¸€äº›æŒ‡å®šå€¼æ¯”å¦‚hostnameï¼Œæ‰€ä»¥éœ€è¦åœ¨å¯è¯»å¯å†™å±‚ä¿®æ”¹ï¼Œä½†æ˜¯è¿™äº›ä¿®æ”¹ä»…å¯¹å½“å‰å®¹å™¨ç”Ÿæ•ˆï¼Œåœ¨docker commitçš„æ—¶å€™å¹¶ä¸å¸Œæœ›è¿åŒè¿™äº›ä¿¡æ¯ä¸€èµ·æäº¤ã€‚æ‰€ä»¥dockerä¿®æ”¹äº†è¿™äº›å†…å®¹åå•ç‹¬æŒ‚è½½åˆ°Initå±‚ä¸­ï¼Œè¿™æ ·åœ¨docker commitçš„æ—¶å€™å°±ä¸ä¼šæäº¤è¿™ä¸€å±‚ï¼Œåªä¼šæäº¤å¯è¯»å¯å†™å±‚ã€‚</p>
<p>æœ€ç»ˆè¿™ä¸‰éƒ¨åˆ†ä¸‹çš„layeréƒ½è¢«è”åˆæŒ‚è½½åˆ°/var/lib/docker/aufs/mntç›®å½•ä¸‹ï¼Œè¡¨ç°ä¸ºä¸€ä¸ªå®Œæ•´çš„Ubuntuæ“ä½œç³»ç»Ÿç›®å½•ã€‚</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Docker/" rel="tag"># Docker</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/12/12/%F0%9F%90%91%E6%96%B0%E5%86%A0%E5%BA%94%E5%AF%B9%E6%8C%87%E5%8D%97/" rel="prev" title="ğŸ‘æ–°å† åº”å¯¹æŒ‡å—">
      <i class="fa fa-chevron-left"></i> ğŸ‘æ–°å† åº”å¯¹æŒ‡å—
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/01/07/%E7%A7%91%E7%A0%94%E5%AE%9E%E7%94%A8%E7%BD%91%E7%AB%99/" rel="next" title="ç§‘ç ”å®ç”¨ç½‘ç«™">
      ç§‘ç ”å®ç”¨ç½‘ç«™ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker%E5%BF%85%E4%BC%9A%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="nav-text">Dockerå¿…ä¼šçŸ¥è¯†ç‚¹</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-text">1.å¸¸ç”¨å‘½ä»¤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E6%9C%8D%E5%8A%A1"><span class="nav-text">1.1 æœåŠ¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E9%95%9C%E5%83%8F"><span class="nav-text">1.2 é•œåƒ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-%E5%AE%B9%E5%99%A8"><span class="nav-text">1.3 å®¹å™¨</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-1-%E5%AE%B9%E5%99%A8%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-text">1.3.1 å®¹å™¨ç”Ÿå‘½å‘¨æœŸ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-2-%E8%BF%9B%E5%85%A5%E5%AE%B9%E5%99%A8"><span class="nav-text">1.3.2 è¿›å…¥å®¹å™¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-3-%E5%AF%BC%E5%87%BA%E5%92%8C%E5%AF%BC%E5%85%A5"><span class="nav-text">1.3.3 å¯¼å‡ºå’Œå¯¼å…¥</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-%E5%85%B6%E5%AE%83"><span class="nav-text">1.4 å…¶å®ƒ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF"><span class="nav-text">2. å®¹å™¨æŠ€æœ¯</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E4%BB%8E%E8%BF%9B%E7%A8%8B%E8%AF%B4%E8%B5%B7"><span class="nav-text">2.1 ä»è¿›ç¨‹è¯´èµ·</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E9%9A%94%E7%A6%BB%E4%B8%8E%E9%99%90%E5%88%B6"><span class="nav-text">2.2 éš”ç¦»ä¸é™åˆ¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-%E5%AE%B9%E5%99%A8%E9%95%9C%E5%83%8F"><span class="nav-text">2.3 å®¹å™¨é•œåƒ</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="foursevenlove"
      src="/uploads/funs.jpg">
  <p class="site-author-name" itemprop="name">foursevenlove</p>
  <div class="site-description" itemprop="description">Keep on going never give up!</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">40</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/foursevenlove" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;foursevenlove" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:foursevenlove@gmail.com" title="E-Mail â†’ mailto:foursevenlove@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://blog.foursevenlove.top/" title="http:&#x2F;&#x2F;blog.foursevenlove.top" rel="noopener" target="_blank">Another Blog</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">foursevenlove</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

</body>
</html>
